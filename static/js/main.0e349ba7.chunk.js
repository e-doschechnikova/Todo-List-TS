(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{170:function(e,t,a){e.exports={error:"Error404_error__3j-Z2"}},189:function(e,t,a){e.exports=a(210)},194:function(e,t,a){},195:function(e,t,a){},210:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),i=a.n(o);a(194),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,s,l,u,d=a(172),m=a(305),f=a(127),p=a(128),b=(a(195),a(299)),v=a(300),E=a(287),g=a(302),h=a(291),y=a(303),k=a(304),C=a(301),O=a(45),j=a(56),T=a(21),A=a(123),w=A.a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"9c1a69da-f1af-40a7-806f-4d3b095c12b8"}}),I=function(){return w.get("todo-lists")},x=function(e){return w.post("todo-lists",{title:e})},L=function(e){return w.delete("todo-lists/".concat(e))},S=function(e,t){return w.put("todo-lists/".concat(e),{title:t})},D=function(e){return w.get("todo-lists/".concat(e,"/tasks"))},F=function(e,t){return w.post("todo-lists/".concat(e,"/tasks"),{title:t})},N=function(e,t){return w.delete("todo-lists/".concat(t,"/tasks/").concat(e))},P=function(e,t,a){return w.put("todo-lists/".concat(e,"/tasks/").concat(t),a)},R=function(e){return w.post("auth/login",e)},z=function(){return w.get("auth/me")},K=function(){return w.delete("auth/login")};!function(e){e[e.New=0]="New",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Draft=3]="Draft"}(c||(c={})),function(e){e[e.Low=0]="Low",e[e.Middle=1]="Middle",e[e.Hi=2]="Hi",e[e.Urgently=3]="Urgently",e[e.Later=4]="Later"}(s||(s={})),function(e){e[e.OK=0]="OK",e[e.ERROR=1]="ERROR",e[e.CAPTCHA=10]="CAPTCHA"}(l||(l={})),function(e){e.DEFAULT="/",e.LOGIN="login",e.NOT_FOUND="404"}(u||(u={}));var U=a(57),_=Object(U.b)({name:"app",initialState:{isInitialized:!1,status:"loading",error:null},reducers:{setAppStatusAC:function(e,t){e.status=t.payload.status},setAppErrorAC:function(e,t){e.error=t.payload.error},setIsInitializedAppAC:function(e,t){e.isInitialized=t.payload.value}}}),H=_.reducer,M=_.actions,G=M.setAppStatusAC,Z=M.setAppErrorAC,q=M.setIsInitializedAppAC,B=function(e,t){t.messages.length?e(Z({error:t.messages[0]})):e(Z({error:"Some error occurred"})),e(G({status:"failed"}))},J=function(e,t){e(Z({error:t.message?t.message:"Some error occurred"})),e(G({status:"failed"}))},W=Object(U.b)({name:"todolists",initialState:[],reducers:{removeTodoListAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));a>-1&&e.splice(a,1)},addTodoListAC:function(e,t){e.unshift.apply(e,[Object(j.a)(Object(j.a)({},t.payload.todolist),{},{filter:"all",entityStatus:"idle"})].concat(Object(T.a)(e)))},changeTodoListTitleAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].title=t.payload.title},changeTodoListFilterAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].filter=t.payload.filter},changeTodolistEntityStatusAC:function(e,t){var a=e.findIndex((function(e){return e.id===t.payload.id}));e[a].entityStatus=t.payload.status},setTodolistsAC:function(e,t){return t.payload.todolists.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{filter:"all",entityStatus:"idle"})}))}},extraReducers:{}}),$=W.reducer,V=W.actions,Y=V.removeTodoListAC,Q=V.addTodoListAC,X=V.changeTodoListTitleAC,ee=V.changeTodoListFilterAC,te=V.setTodolistsAC,ae=V.changeTodolistEntityStatusAC,ne=a(20),re=a.n(ne),oe=a(29),ie=Object(U.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(e,t){var a=e[t.payload.todolistID],n=a.findIndex((function(e){return e.id===t.payload.taskID}));n>-1&&a.splice(n,1)},addTaskAC:function(e,t){e[t.payload.task.todoListId].unshift(t.payload.task)},updateTaskAC:function(e,t){var a=e[t.payload.todolistID],n=a.findIndex((function(e){return e.id===t.payload.taskID}));n>-1&&(a[n]=Object(j.a)(Object(j.a)({},a[n]),t.payload.model))},setTaskAC:function(e,t){e[t.payload.todolistID]=t.payload.tasks}},extraReducers:function(e){e.addCase(Q,(function(e,t){e[t.payload.todolist.id]=[]})),e.addCase(Y,(function(e,t){delete e[t.payload.id]})),e.addCase(te,(function(e,t){t.payload.todolists.forEach((function(t){e[t.id]=[]}))}))}}),ce=ie.reducer,se=ie.actions,le=se.removeTaskAC,ue=se.addTaskAC,de=se.updateTaskAC,me=se.setTaskAC,fe=function(e,t,a){return function(n,r){var o=r().tasks[t].find((function(t){return t.id===e}));if(o){var i=Object(j.a)({title:o.title,deadline:o.deadline,startDate:o.startDate,description:o.description,priority:o.priority,status:o.status},a);n(G({status:"loading"})),P(t,e,i).then((function(r){0===r.data.resultCode?(n(de({taskID:e,model:a,todolistID:t})),n(G({status:"succeeded"}))):B(n,r.data)})).catch((function(e){J(n,e)})).finally((function(){n(G({status:"idle"}))}))}}},pe=a(51),be=a(98),ve=Object(U.b)({name:"auth",initialState:{isLoggedIn:!1},reducers:{setIsLoggedInAC:function(e,t){e.isLoggedIn=t.payload.value}}}),Ee=ve.reducer,ge=ve.actions.setIsLoggedInAC,he=Object(pe.b)({tasks:ce,todolists:$,app:H,auth:Ee}),ye=Object(U.a)({reducer:he,middleware:function(e){return e().prepend(be.a)}}),ke=function(){return Object(O.b)()},Ce=O.c;window.store=ye;var Oe=a(292),je=a(211),Te=a(12),Ae=a(307),we=a(288),Ie=Object(n.memo)((function(e){var t=e.addItem,a=e.disabled,o=r.a.useState(""),i=Object(Te.a)(o,2),c=i[0],s=i[1],l=Object(n.useState)(!1),u=Object(Te.a)(l,2),d=u[0],m=u[1],f=function(){var e=c.trim();e?t(e):m(!0),s("")};return r.a.createElement("div",null,r.a.createElement(Ae.a,{variant:"outlined",size:"small",value:c,onChange:function(e){s(e.currentTarget.value),d&&m(!1)},onKeyDown:function(e){return"Enter"===e.key&&f()},label:"Add title",error:d,helperText:d&&"Title is required!",disabled:a}),r.a.createElement(E.a,{color:"secondary",disabled:a},r.a.createElement(we.a,{onClick:f})))})),xe=Object(n.memo)((function(e){var t=e.title,a=e.changeTitle,o=r.a.useState(t),i=Object(Te.a)(o,2),c=i[0],s=i[1],l=Object(n.useState)(!1),u=Object(Te.a)(l,2),d=u[0],m=u[1],f=function(){m(!1),a(c)};return d?r.a.createElement(Ae.a,{color:"primary",value:c,onChange:function(e){s(e.currentTarget.value)},onKeyDown:function(e){return"Enter"===e.key&&f()},onBlur:f,autoFocus:!0}):r.a.createElement("span",{onDoubleClick:function(){m(!0)}},t)})),Le=a(286),Se=a(290),De=a(289),Fe=a(311),Ne=Object(n.memo)((function(e){var t=e.task,a=e.todolistID,o=e.removeTask,i=e.changeTaskStatus,s=e.changeTaskTitle,l=Object(j.a)({},t),u=l.id,d=l.status,m=l.title,f=Object(n.useCallback)((function(){return o(t.id,a)}),[t.id,a,o]),p=Object(n.useCallback)((function(e){var t=e.currentTarget.checked;i(u,a,t?c.Completed:c.New)}),[u,a,i]),b=Object(n.useCallback)((function(e){s(u,e,a)}),[u,a,s]);return r.a.createElement(De.a,{key:u,className:d===c.Completed?"task isDone":"",alignItems:"center",disableGutters:!0,divider:!0},r.a.createElement(Fe.a,{size:"small",color:"primary",onChange:p,checked:d===c.Completed}),r.a.createElement(xe,{title:m,changeTitle:b}),r.a.createElement(E.a,null,r.a.createElement(Se.a,{onClick:f})))})),Pe=Object(n.memo)((function(e){var t=ke();Object(n.useEffect)((function(){var a;t((a=e.todolist.id,function(e){e(G({status:"loading"})),D(a).then((function(t){var n=t.data.items;e(me({tasks:n,todolistID:a})),e(G({status:"succeeded"}))}))}))}),[]);var a=e.tasks;"active"===e.todolist.filter&&(a=e.tasks.filter((function(e){return e.status===c.New}))),"completed"===e.todolist.filter&&(a=e.tasks.filter((function(e){return e.status===c.Completed})));var o=function(t){return function(){return e.changeTodoListFilter(t,e.todolist.id)}},i=Object(n.useCallback)((function(t){return e.addTask(t,e.todolist.id)}),[e.addTask,e.todolist.id]),s=a.length?a.map((function(t){return r.a.createElement(Ne,{key:t.id,task:t,todolistID:e.todolist.id,removeTask:e.removeTask,changeTaskTitle:e.changeTaskTitle,changeTaskStatus:e.changeTaskStatus})})):r.a.createElement("span",null,'I"m empty! Fill me up! ',r.a.createElement("b",null,"\u32e1"));return r.a.createElement("div",null,r.a.createElement("h3",null,r.a.createElement(xe,{title:e.todolist.title,changeTitle:function(t){return e.changeTodoListTitle(t,e.todolist.id)}}),r.a.createElement(E.a,{disabled:"loading"===e.entityStatus},r.a.createElement(Se.a,{color:"primary",onClick:function(){return e.removeTodolist(e.todolist.id)}}))),r.a.createElement(Ie,{addItem:i,disabled:"loading"===e.entityStatus}),r.a.createElement(Le.a,{style:{listStyle:"none"}},s),r.a.createElement("div",null,r.a.createElement(h.a,{size:"small",variant:"outlined",color:"all"===e.todolist.filter?"secondary":"primary",onClick:o("all"),style:{margin:"5px"}},"All"),r.a.createElement(h.a,{size:"small",variant:"outlined",color:"active"===e.todolist.filter?"secondary":"primary",onClick:o("active"),style:{margin:"5px"}},"Active"),r.a.createElement(h.a,{size:"small",variant:"outlined",color:"completed"===e.todolist.filter?"secondary":"primary",onClick:o("completed"),style:{margin:"5px"}},"Completed")))})),Re=a(16),ze=function(){var e=Object(O.c)((function(e){return e.todolists})),t=Object(O.c)((function(e){return e.tasks})),a=ke(),o=Object(O.c)((function(e){return e.auth.isLoggedIn}));Object(n.useEffect)((function(){o&&a((function(e){e(G({status:"loading"})),I().then((function(t){e(te({todolists:t.data})),e(G({status:"succeeded"}))})).catch((function(){e(G({status:"failed"}))}))}))}),[]);var i=Object(n.useCallback)((function(e,t){a(function(e,t){return function(){var a=Object(oe.a)(re.a.mark((function a(n){var r,o,i;return re.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n(G({status:"loading"})),a.next=4,N(e,t);case 4:n(le({taskID:e,todolistID:t})),n(G({status:"succeeded"})),a.next=13;break;case 8:a.prev=8,a.t0=a.catch(0),r=a.t0,A.a.isAxiosError(r)&&(i=(null===(o=r.response)||void 0===o?void 0:o.data)?r.response.data.error:r.message,n(Z({error:i}))),n(G({status:"failed"}));case 13:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(e){return a.apply(this,arguments)}}()}(e,t))}),[a]),c=Object(n.useCallback)((function(e,t){a(function(e,t){return function(a){a(G({status:"loading"})),F(t,e).then((function(e){e.data.resultCode===l.OK?(a(ue({task:e.data.data.item})),a(G({status:"succeeded"}))):B(a,e.data)})).catch((function(e){J(a,e)})).finally((function(){a(G({status:"idle"}))}))}}(e,t))}),[a]),s=Object(n.useCallback)((function(e,t,n){a(fe(e,t,{status:n}))}),[a]),d=Object(n.useCallback)((function(e,t,n){a(fe(e,n,{title:t}))}),[a]),m=Object(n.useCallback)((function(e,t){var n=function(e,t){return function(a){a(G({status:"loading"})),S(t,e).then((function(){a(X({title:e,id:t})),a(G({status:"succeeded"}))}))}}(e,t);a(n)}),[a]),f=Object(n.useCallback)((function(e,t){a(ee({id:t,filter:e}))}),[a]),p=Object(n.useCallback)((function(e){var t=function(e){return function(t){t(G({status:"loading"})),t(ae({id:e,status:"loading"})),L(e).then((function(){t(Y({id:e})),t(G({status:"succeeded"}))})).catch((function(a){t(ae({id:e,status:"idle"})),J(t,a)})).finally((function(){t(G({status:"idle"}))}))}}(e);a(t)}),[a]),b=Object(n.useCallback)((function(e){var t=function(e){return function(t){t(G({status:"loading"})),x(e).then((function(e){0===e.data.resultCode?t(Q({todolist:e.data.data.item})):B(t,e.data)})).catch((function(e){J(t,e)}))}}(e);a(t)}),[a]),v=e.map((function(e){var a=t[e.id];return r.a.createElement(Oe.a,{item:!0,key:e.id},r.a.createElement(je.a,{variant:"elevation",style:{padding:"20px"}},r.a.createElement(Pe,{todolist:e,tasks:a,entityStatus:e.entityStatus,addTask:c,removeTask:i,removeTodolist:p,changeTaskStatus:s,changeTodoListFilter:f,changeTaskTitle:d,changeTodoListTitle:m})))}));return o?r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe.a,{container:!0,style:{padding:"20px 0"}},r.a.createElement(Ie,{addItem:b})),r.a.createElement(Oe.a,{container:!0,spacing:4},v)):r.a.createElement(Re.a,{to:u.LOGIN})},Ke=a(295),Ue=a(312),_e=a(309),He=n.forwardRef((function(e,t){return n.createElement(_e.a,Object.assign({elevation:6,ref:t,variant:"standard"},e))}));function Me(){var e=Object(O.b)(),t=Ce((function(e){return e.app.error})),a=function(t,a){"clickaway"!==a&&e(Z({error:null}))};return n.createElement("div",null,n.createElement(Ke.a,{spacing:2,sx:{width:"100%"}},n.createElement(Ue.a,{open:!!t,autoHideDuration:6e3,onClose:a},n.createElement(He,{onClose:a,severity:"error",sx:{width:"100%"}},t,"\ud83d\ude20"))))}var Ge=a(317),Ze=a(310),qe=a(313),Be=a(314),Je=a(319),We=a(297),$e=a(306),Ve=a(318),Ye=a(171),Qe=function(){var e=ke(),t=Object(O.c)((function(e){return e.auth.isLoggedIn}));Object(n.useEffect)((function(){e(G({status:"succeeded"}))}),[]);var a=Object(Ye.a)({initialValues:{email:"",password:"",rememberMe:!1,captcha:""},validate:function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address \u26a0"):t.email="Required",e.password?e.password.length<3&&(t.password="Password should be more 3 symbols \u26a0"):t.password="Required",t},onSubmit:function(t){var n;e((n=t,function(){var e=Object(oe.a)(re.a.mark((function e(t){var a;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(G({status:"loading"})),e.prev=1,e.next=4,R(n);case 4:(a=e.sent).data.resultCode===l.OK?(t(ge({value:!0})),t(G({status:"succeeded"}))):B(t,a.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),J(t,e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())),a.resetForm()}});return t?r.a.createElement(Re.a,{to:u.DEFAULT}):r.a.createElement(Ge.a,{container:!0,justifyContent:"center"},r.a.createElement(Ge.a,{item:!0,justifyContent:"center"},r.a.createElement("form",{onSubmit:a.handleSubmit},r.a.createElement(qe.a,null,r.a.createElement(We.a,null,r.a.createElement("p",null,"To log in get registered",r.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank"}," here")),r.a.createElement("p",null,"or use common test account credentials:"),r.a.createElement("p",null,"Email: free@samuraijs.com"),r.a.createElement("p",null,"Password: free")),r.a.createElement(Je.a,null,r.a.createElement($e.a,Object.assign({},a.getFieldProps("email"),{label:"Email",margin:"normal"})),a.errors.email&&r.a.createElement("div",{style:{color:"red"}},a.touched.email&&a.errors.email),r.a.createElement($e.a,Object.assign({},a.getFieldProps("password"),{type:"password",label:"Password",margin:"normal"})),a.touched.password&&a.errors.password&&r.a.createElement("div",{style:{color:"red"}},a.errors.password),r.a.createElement(Be.a,{label:"Remember me",control:r.a.createElement(Ze.a,Object.assign({},a.getFieldProps("rememberMe"),{checked:a.values.rememberMe}))}),r.a.createElement(Ve.a,{type:"submit",color:"secondary",variant:"outlined"},"Login"))))))},Xe=a(170),et=a.n(Xe);function tt(){var e=ke();return Object(n.useEffect)((function(){e(G({status:"succeeded"}))}),[]),r.a.createElement("div",{className:et.a.error},r.a.createElement("h1",null,"404"),r.a.createElement("h2",null,"OOPS! PAGE NOT FOUND!"))}var at=a(320);var nt=function(){var e=Ce((function(e){return e.app.status})),t=ke(),a=Ce((function(e){return e.app.isInitialized})),o=Object(O.c)((function(e){return e.auth.isLoggedIn}));return Object(n.useEffect)((function(){t(function(){var e=Object(oe.a)(re.a.mark((function e(t){var a;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(G({status:"loading"})),e.prev=1,e.next=4,z();case 4:0===(a=e.sent).data.resultCode?(t(ge({value:!0})),t(G({status:"succeeded"}))):B(t,a.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),J(t,e.t0);case 11:return e.prev=11,t(q({value:!0})),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(t){return e.apply(this,arguments)}}())}),[]),a?r.a.createElement("div",{className:"App"},r.a.createElement(Me,null),r.a.createElement(b.a,{position:"static",color:"transparent"},r.a.createElement(v.a,{style:{justifyContent:"space-between"}},r.a.createElement(E.a,{edge:"start",color:"secondary","aria-label":"menu"},r.a.createElement(C.a,null)),r.a.createElement(g.a,{variant:"h5"},"Todolists"),o&&r.a.createElement(h.a,{onClick:function(){t(function(){var e=Object(oe.a)(re.a.mark((function e(t){var a;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(G({status:"loading"})),e.prev=1,e.next=4,K();case 4:(a=e.sent).data.resultCode===l.OK?(t(ge({value:!1})),t(G({status:"succeeded"}))):B(t,a.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),J(t,e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())},color:"secondary",variant:"outlined"},"Log out")),"loading"===e&&r.a.createElement(y.a,{color:"secondary"})),r.a.createElement(k.a,{fixed:!0},r.a.createElement(Re.d,null,r.a.createElement(Re.b,{path:"/*",element:r.a.createElement(ze,null)}),r.a.createElement(Re.b,{path:"login",element:r.a.createElement(Qe,null)}),r.a.createElement(Re.b,{path:"/todolist",element:r.a.createElement(ze,null)}),r.a.createElement(Re.b,{path:"*",element:r.a.createElement(Re.a,{to:"/404"})}),r.a.createElement(Re.b,{path:"/404",element:r.a.createElement(tt,null)})))):r.a.createElement("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"}},r.a.createElement(at.a,{color:"secondary"}))},rt=a(94),ot=Object(d.a)({palette:{primary:f.a,secondary:p.a,type:"light"}});i.a.render(r.a.createElement(O.a,{store:ye},r.a.createElement(m.a,{theme:ot},r.a.createElement(rt.a,null,r.a.createElement(nt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[189,1,2]]]);
//# sourceMappingURL=main.0e349ba7.chunk.js.map